let e=[],t=[],o=[],n=[],i=!1;async function a(e,t){if("undefined"!=typeof window&&void 0!==window.document)return await async function(e,t){if(!crypto||!crypto.subtle)throw new Error("Web Crypto API não disponível");const o=await crypto.subtle.importKey("raw",(new TextEncoder).encode(t),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),n=await crypto.subtle.sign("HMAC",o,(new TextEncoder).encode(e));return btoa(String.fromCharCode(...new Uint8Array(n)))}(e,t);if("undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node)return async function(e,t){try{let o;if("undefined"!=typeof require?o=require("crypto"):"undefined"!=typeof process&&process.versions?.node&&(o=(await import("crypto")).default),o?.createHmac)return o.createHmac("sha256",t).update(e).digest("base64");throw new Error("createHmac não disponível")}catch(e){throw new Error("Módulo crypto do Node.js não disponível")}}(e,t);throw new Error("Ambiente não suportado para HMAC")}async function r(e,t,o){try{return await a(e,o)===t}catch(e){return!1}}class s{constructor(e={}){this.options=e,this.collectOptions={collectPlugins:!1,collectStorage:!1,collectBehavior:!1,...e.collectOptions||{}}}configureCollect(e={}){this.collectOptions={...this.collectOptions,...e}}async collect(){return await function(a={}){return i||"undefined"==typeof window||!1===a.collectBehavior||(window.addEventListener("mousemove",(t=>{e.push({x:t.clientX,y:t.clientY,timestamp:Date.now()}),e.length>100&&e.shift()})),window.addEventListener("keydown",(e=>{t.push({key:e.key,timestamp:Date.now(),ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey}),t.length>100&&t.shift()})),window.addEventListener("focus",(e=>{o.push({type:"focus",timestamp:Date.now(),target:e.target?.tagName||""})}),!0),window.addEventListener("blur",(e=>{o.push({type:"blur",timestamp:Date.now(),target:e.target?.tagName||""})}),!0),window.addEventListener("scroll",(e=>{n.push({x:window.scrollX,y:window.scrollY,timestamp:Date.now()}),n.length>100&&n.shift()})),i=!0),{timestamp:Date.now(),browser:{userAgent:navigator.userAgent,language:navigator.language,languages:navigator.languages,platform:navigator.platform,cookieEnabled:navigator.cookieEnabled,doNotTrack:navigator.doNotTrack,hardwareConcurrency:navigator.hardwareConcurrency,maxTouchPoints:navigator.maxTouchPoints,vendor:navigator.vendor,vendorSub:navigator.vendorSub},screen:{width:window.screen.width,height:window.screen.height,availWidth:window.screen.availWidth,availHeight:window.screen.availHeight,colorDepth:window.screen.colorDepth,pixelDepth:window.screen.pixelDepth,orientation:window.screen.orientation?.type||null,devicePixelRatio:window.devicePixelRatio},timezone:{timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,timezoneOffset:(new Date).getTimezoneOffset(),timestamp:Date.now(),locale:navigator.language},plugins:!1!==a.collectPlugins?Array.from(navigator.plugins||[]).map((e=>e.name)):void 0,storage:!1!==a.collectStorage?{localStorage:!!window.localStorage,sessionStorage:!!window.sessionStorage,indexedDB:!!window.indexedDB,cookies:navigator.cookieEnabled}:void 0,behavior:!1!==a.collectBehavior?{mouseEvents:[...e],keyboardEvents:[...t],focusEvents:[...o],scrollEvents:[...n]}:void 0}}(this.collectOptions)}async send(e){return await async function(e,t){const o=await a(JSON.stringify(e),t.secret);return await fetch(t.endpoint,{method:"POST",headers:{"Content-Type":"application/json","X-SDK-Signature":o},body:JSON.stringify(e)})}(e,this.options)}async collectAndSend(){const e=await this.collect();return await this.send(e)}async checkRisk(e){const t=await this.collect();t.action=e;const o=await this.send(t);return await o.json()}startAutoCollection(){}stopAutoCollection(){}configure(e){Object.assign(this.options,e)}destroy(){}}function c(e={}){return new s(e)}export{s as Veritas,a as createHmac,s as default,c as init,r as verifyHmac};
//# sourceMappingURL=veritas-sdk.esm.js.map
