"use strict";Object.defineProperty(exports,"__esModule",{value:!0});function e(){try{const e=document.createElement("canvas"),t=e.getContext("2d");return t.textBaseline="top",t.font="14px 'Arial'",t.textBaseline="alphabetic",t.fillStyle="#f60",t.fillRect(125,1,62,20),t.fillStyle="#069",t.fillText("fingerprint",2,15),t.fillStyle="rgba(102, 204, 0, 0.7)",t.fillText("fingerprint",4,17),e.toDataURL()}catch(e){return"unavailable"}}const t=new class{constructor(){this.mouseEvents=[],this.keyboardEvents=[],this.focusEvents=[],this.scrollEvents=[],this.clickEvents=[],this.listenersInitialized=!1}initListeners(){this.listenersInitialized||"undefined"==typeof window||(window.addEventListener("mousemove",e=>{this.mouseEvents.push({x:e.clientX,y:e.clientY,timestamp:Date.now()}),this.mouseEvents.length>100&&this.mouseEvents.shift()}),window.addEventListener("keydown",e=>{this.keyboardEvents.push({key:e.key,timestamp:Date.now(),ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey}),this.keyboardEvents.length>100&&this.keyboardEvents.shift()}),window.addEventListener("focus",e=>{this.focusEvents.push({type:"focus",timestamp:Date.now(),target:e.target?.tagName||""})},!0),window.addEventListener("blur",e=>{this.focusEvents.push({type:"blur",timestamp:Date.now(),target:e.target?.tagName||""})},!0),window.addEventListener("scroll",()=>{this.scrollEvents.push({x:window.scrollX,y:window.scrollY,timestamp:Date.now()}),this.scrollEvents.length>100&&this.scrollEvents.shift()}),window.addEventListener("click",e=>{this.clickEvents.push({timestamp:Date.now(),x:e.clientX,y:e.clientY}),this.clickEvents.length>100&&this.clickEvents.shift()}),this.listenersInitialized=!0)}clickFrequency(e=1e4){const t=Date.now();return this.clickEvents.filter(n=>t-n.timestamp<=e).length/(e/1e3)}avgClickInterval(){if(this.clickEvents.length<2)return null;let e=[];for(let t=1;t<this.clickEvents.length;t++)e.push(this.clickEvents[t].timestamp-this.clickEvents[t-1].timestamp);return e.reduce((e,t)=>e+t,0)/e.length}getBehavior(){return{mouseEvents:[...this.mouseEvents],keyboardEvents:[...this.keyboardEvents],focusEvents:[...this.focusEvents],scrollEvents:[...this.scrollEvents],clickEvents:[...this.clickEvents],clickFrequency:this.clickFrequency(),avgClickInterval:this.avgClickInterval()}}};async function n(e,t){if("undefined"!=typeof window&&void 0!==window.document)return await async function(e,t){if(!crypto||!crypto.subtle)throw new Error("Web Crypto API não disponível");const n=await crypto.subtle.importKey("raw",(new TextEncoder).encode(t),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),i=await crypto.subtle.sign("HMAC",n,(new TextEncoder).encode(e));return btoa(String.fromCharCode(...new Uint8Array(i)))}(e,t);if("undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node)return async function(e,t){try{let n;if("undefined"!=typeof require?n=require("crypto"):"undefined"!=typeof process&&process.versions?.node&&(n=(await import("crypto")).default),n?.createHmac)return n.createHmac("sha256",t).update(e).digest("base64");throw new Error("createHmac não disponível")}catch(e){throw new Error("Módulo crypto do Node.js não disponível")}}(e,t);throw new Error("Ambiente não suportado para HMAC")}class i{constructor(e={}){this.options=e,this.collectOptions={collectPlugins:!1,collectStorage:!1,collectBehavior:!1,...e.collectOptions||{}}}configureCollect(e={}){this.collectOptions={...this.collectOptions,...e}}async collect(){return await function(n={}){return!1!==n.collectBehavior&&t.initListeners(),{timestamp:Date.now(),browser:{userAgent:navigator.userAgent,language:navigator.language,languages:navigator.languages,cookieEnabled:navigator.cookieEnabled,doNotTrack:navigator.doNotTrack,hardwareConcurrency:navigator.hardwareConcurrency,maxTouchPoints:navigator.maxTouchPoints},fingerprint:!1!==n.collectFingerprint?e():void 0,timezone:{timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,timezoneOffset:(new Date).getTimezoneOffset(),timestamp:Date.now(),locale:navigator.language},plugins:!1!==n.collectPlugins?Array.from(navigator.plugins||[]).map(e=>e.name):void 0,storage:!1!==n.collectStorage?{localStorage:!!window.localStorage,sessionStorage:!!window.sessionStorage,indexedDB:!!window.indexedDB,cookies:navigator.cookieEnabled}:void 0,behavior:!1!==n.collectBehavior?{screen:{width:window.screen.width,height:window.screen.height,availWidth:window.screen.availWidth,availHeight:window.screen.availHeight,colorDepth:window.screen.colorDepth,pixelDepth:window.screen.pixelDepth,orientation:window.screen.orientation?.type||null,devicePixelRatio:window.devicePixelRatio},...t.getBehavior()}:void 0}}(this.collectOptions)}async send(e){return await async function(e,t){const i=await n(JSON.stringify(e),t.secret);return await fetch(t.endpoint,{method:"POST",headers:{"Content-Type":"application/json","X-SDK-Signature":i},body:JSON.stringify(e)})}(e,this.options)}async collectAndSend(){const e=await this.collect();return await this.send(e)}async checkRisk(e){const t=await this.collect();t.action=e;const n=await this.send(t);return await n.json()}startAutoCollection(){}stopAutoCollection(){}configure(e){Object.assign(this.options,e)}destroy(){}}exports.Veritas=i,exports.createHmac=n,exports.default=i,exports.init=function(e={}){return new i(e)},exports.verifyHmac=async function(e,t,i){try{return await n(e,i)===t}catch(e){return!1}};
//# sourceMappingURL=veritas-sdk.cjs.js.map
