{"version":3,"file":"veritas-sdk.umd.min.js","sources":["../src/utils.js","../src/collector.js","../src/crypto.js","../src/sender.js","../src/index.js"],"sourcesContent":["// Utilit√°rios compartilhados entre browser e Node.js\nexport function debounce(func, wait) {\n  let timeout;\n  return function executedFunction(...args) {\n    const later = () => {\n      clearTimeout(timeout);\n      func(...args);\n    };\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n  };\n}\n\nexport function generateId() {\n  return Math.random().toString(36).substr(2, 9) + Date.now().toString(36);\n}\n\nexport function isNode() {\n  return typeof window === 'undefined' && typeof global !== 'undefined';\n}\n\nexport function isBrowser() {\n  return typeof window !== 'undefined' && typeof document !== 'undefined';\n}\n\n// Hash simples para fingerprinting\nexport function simpleHash(str) {\n  let hash = 0;\n  if (str.length === 0) return hash;\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i);\n    hash = ((hash << 5) - hash) + char;\n    hash = hash & hash; // Convert to 32bit integer\n  }\n  return Math.abs(hash).toString(36);\n}\n\n","import { debounce, simpleHash, isBrowser } from './utils.js';\n\nclass DataCollector {\n  constructor() {\n    this.mouseEvents = [];\n    this.keyboardEvents = [];\n    this.focusEvents = [];\n    this.scrollEvents = [];\n    this.sessionData = {};\n    \n    if (isBrowser()) {\n      this.initBrowserCollectors();\n    }\n  }\n\n  initBrowserCollectors() {\n    // Coleta de movimentos do mouse (debounced)\n    const debouncedMouseMove = debounce((e) => {\n      this.mouseEvents.push({\n        x: e.clientX,\n        y: e.clientY,\n        timestamp: Date.now()\n      });\n      \n      // Manter apenas os √∫ltimos 50 eventos\n      if (this.mouseEvents.length > 50) {\n        this.mouseEvents = this.mouseEvents.slice(-50);\n      }\n    }, 100);\n\n    // Coleta de eventos de teclado (sem capturar conte√∫do)\n    const debouncedKeyboard = debounce((e) => {\n      this.keyboardEvents.push({\n        key: e.key.length === 1 ? 'char' : e.key, // N√£o captura caracteres espec√≠ficos\n        timestamp: Date.now(),\n        ctrlKey: e.ctrlKey,\n        altKey: e.altKey,\n        shiftKey: e.shiftKey\n      });\n      \n      if (this.keyboardEvents.length > 30) {\n        this.keyboardEvents = this.keyboardEvents.slice(-30);\n      }\n    }, 50);\n\n    // Eventos de foco\n    const focusHandler = (e) => {\n      this.focusEvents.push({\n        type: e.type,\n        timestamp: Date.now(),\n        target: e.target.tagName\n      });\n      \n      if (this.focusEvents.length > 20) {\n        this.focusEvents = this.focusEvents.slice(-20);\n      }\n    };\n\n    // Eventos de scroll\n    const debouncedScroll = debounce(() => {\n      this.scrollEvents.push({\n        x: window.scrollX,\n        y: window.scrollY,\n        timestamp: Date.now()\n      });\n      \n      if (this.scrollEvents.length > 20) {\n        this.scrollEvents = this.scrollEvents.slice(-20);\n      }\n    }, 200);\n\n    // Adicionar listeners\n    document.addEventListener('mousemove', debouncedMouseMove);\n    document.addEventListener('keydown', debouncedKeyboard);\n    document.addEventListener('focus', focusHandler, true);\n    document.addEventListener('blur', focusHandler, true);\n    window.addEventListener('scroll', debouncedScroll);\n  }\n\n  // Coleta informa√ß√µes b√°sicas do navegador\n  getBrowserInfo() {\n    if (!isBrowser()) return {};\n\n    return {\n      userAgent: navigator.userAgent,\n      language: navigator.language,\n      languages: navigator.languages,\n      platform: navigator.platform,\n      cookieEnabled: navigator.cookieEnabled,\n      doNotTrack: navigator.doNotTrack,\n      hardwareConcurrency: navigator.hardwareConcurrency,\n      maxTouchPoints: navigator.maxTouchPoints,\n      vendor: navigator.vendor,\n      vendorSub: navigator.vendorSub\n    };\n  }\n\n  // Coleta informa√ß√µes da tela\n  getScreenInfo() {\n    if (!isBrowser()) return {};\n\n    return {\n      width: screen.width,\n      height: screen.height,\n      availWidth: screen.availWidth,\n      availHeight: screen.availHeight,\n      colorDepth: screen.colorDepth,\n      pixelDepth: screen.pixelDepth,\n      orientation: screen.orientation ? screen.orientation.type : null,\n      devicePixelRatio: window.devicePixelRatio\n    };\n  }\n\n  // Coleta informa√ß√µes de timezone\n  getTimezoneInfo() {\n    const now = new Date();\n    return {\n      timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,\n      timezoneOffset: now.getTimezoneOffset(),\n      timestamp: now.getTime(),\n      locale: Intl.DateTimeFormat().resolvedOptions().locale\n    };\n  }\n\n  // Canvas fingerprinting\n  getCanvasFingerprint() {\n    if (!isBrowser()) return null;\n\n    try {\n      const canvas = document.createElement('canvas');\n      const ctx = canvas.getContext('2d');\n      \n      // Desenhar texto e formas para criar fingerprint √∫nico\n      ctx.textBaseline = 'top';\n      ctx.font = '14px Arial';\n      ctx.fillText('Veritas SDK Canvas Test üîí', 2, 2);\n      \n      ctx.fillStyle = 'rgba(102, 204, 0, 0.7)';\n      ctx.fillRect(100, 5, 80, 20);\n      \n      const dataURL = canvas.toDataURL();\n      return simpleHash(dataURL);\n    } catch (error) {\n      return null;\n    }\n  }\n\n  // WebGL fingerprinting\n  getWebGLFingerprint() {\n    if (!isBrowser()) return null;\n\n    try {\n      const canvas = document.createElement('canvas');\n      const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');\n      \n      if (!gl) return null;\n\n      const renderer = gl.getParameter(gl.RENDERER);\n      const vendor = gl.getParameter(gl.VENDOR);\n      const version = gl.getParameter(gl.VERSION);\n      const shadingLanguageVersion = gl.getParameter(gl.SHADING_LANGUAGE_VERSION);\n      \n      const fingerprint = `${renderer}|${vendor}|${version}|${shadingLanguageVersion}`;\n      return simpleHash(fingerprint);\n    } catch (error) {\n      return null;\n    }\n  }\n\n  // Audio fingerprinting\n  getAudioFingerprint() {\n    if (!isBrowser()) return null;\n\n    try {\n      const audioContext = new (window.AudioContext || window.webkitAudioContext)();\n      const oscillator = audioContext.createOscillator();\n      const analyser = audioContext.createAnalyser();\n      const gainNode = audioContext.createGain();\n      \n      oscillator.connect(analyser);\n      analyser.connect(gainNode);\n      gainNode.connect(audioContext.destination);\n      \n      oscillator.frequency.value = 1000;\n      gainNode.gain.value = 0;\n      \n      const fingerprint = `${audioContext.sampleRate}|${audioContext.state}|${analyser.frequencyBinCount}`;\n      \n      audioContext.close();\n      return simpleHash(fingerprint);\n    } catch (error) {\n      return null;\n    }\n  }\n\n  // Coleta informa√ß√µes de plugins (limitado por seguran√ßa moderna)\n  getPluginsInfo() {\n    if (!isBrowser() || !navigator.plugins) return [];\n\n    const plugins = [];\n    for (let i = 0; i < navigator.plugins.length; i++) {\n      const plugin = navigator.plugins[i];\n      plugins.push({\n        name: plugin.name,\n        description: plugin.description,\n        filename: plugin.filename\n      });\n    }\n    return plugins;\n  }\n\n  // Coleta dados de armazenamento local\n  getStorageInfo() {\n    if (!isBrowser()) return {};\n\n    const storage = {};\n    \n    try {\n      storage.localStorage = !!window.localStorage;\n      storage.sessionStorage = !!window.sessionStorage;\n      storage.indexedDB = !!window.indexedDB;\n      storage.webSQL = !!window.openDatabase;\n    } catch (error) {\n      // Alguns navegadores podem bloquear acesso ao storage\n    }\n\n    return storage;\n  }\n\n  // M√©todo principal para coletar todos os dados\n  collectAll() {\n    const data = {\n      sessionId: this.sessionData.sessionId || (this.sessionData.sessionId = Date.now().toString(36)),\n      timestamp: Date.now(),\n      browser: this.getBrowserInfo(),\n      screen: this.getScreenInfo(),\n      timezone: this.getTimezoneInfo(),\n      fingerprints: {\n        canvas: this.getCanvasFingerprint(),\n        webgl: this.getWebGLFingerprint(),\n        audio: this.getAudioFingerprint()\n      },\n      plugins: this.getPluginsInfo(),\n      storage: this.getStorageInfo(),\n      behavior: {\n        mouseEvents: [...this.mouseEvents],\n        keyboardEvents: [...this.keyboardEvents],\n        focusEvents: [...this.focusEvents],\n        scrollEvents: [...this.scrollEvents]\n      }\n    };\n\n    return data;\n  }\n}\n\nexport { DataCollector };\n\n","import { isNode, isBrowser } from './utils.js';\n\n// Implementa√ß√£o HMAC para browser\nasync function browserHmac(message, secret) {\n  if (!crypto || !crypto.subtle) {\n    throw new Error('Web Crypto API n√£o dispon√≠vel');\n  }\n  \n  const key = await crypto.subtle.importKey(\n    'raw',\n    new TextEncoder().encode(secret),\n    { name: 'HMAC', hash: 'SHA-256' },\n    false,\n    ['sign']\n  );\n  \n  const signature = await crypto.subtle.sign(\n    'HMAC',\n    key,\n    new TextEncoder().encode(message)\n  );\n  \n  return btoa(String.fromCharCode(...new Uint8Array(signature)));\n}\n\n// Implementa√ß√£o HMAC para Node.js\nfunction nodeHmac(message, secret) {\n  try {\n    // Tentar importa√ß√£o din√¢mica primeiro\n    const crypto = globalThis.crypto || require('crypto');\n    if (crypto.createHmac) {\n      return crypto.createHmac('sha256', secret).update(message).digest('base64');\n    } else {\n      throw new Error('createHmac n√£o dispon√≠vel');\n    }\n  } catch (error) {\n    throw new Error('M√≥dulo crypto do Node.js n√£o dispon√≠vel');\n  }\n}\n\n// Fun√ß√£o HMAC\nexport async function createHmac(message, secret) {\n  if (isBrowser()) {\n    return await browserHmac(message, secret);\n  } else if (isNode()) {\n    return nodeHmac(message, secret);\n  } else {\n    throw new Error('Ambiente n√£o suportado para HMAC');\n  }\n}\n\n// Verifica√ß√£o de assinatura\nexport async function verifyHmac(message, signature, secret) {\n  try {\n    const expectedSignature = await createHmac(message, secret);\n    return expectedSignature === signature;\n  } catch (error) {\n    return false;\n  }\n}\n\n","import { createHmac } from './crypto.js';\nimport { isNode, isBrowser } from './utils.js';\n\nclass DataSender {\n  constructor(options = {}) {\n    this.endpoint = options.endpoint;\n    this.secret = options.secret;\n    this.timeout = options.timeout || 5000;\n    this.retries = options.retries || 2;\n  }\n\n  async sendData(data) {\n    if (!this.endpoint) {\n      throw new Error('Endpoint n√£o configurado');\n    }\n\n    const payload = JSON.stringify(data);\n    let signature = null;\n\n    // Criar assinatura se secret estiver configurado\n    if (this.secret) {\n      try {\n        signature = await createHmac(payload, this.secret);\n      } catch (error) {\n        console.warn('Falha ao criar assinatura HMAC:', error.message);\n      }\n    }\n\n    const headers = {\n      'Content-Type': 'application/json'\n    };\n\n    if (signature) {\n      headers['X-SDK-Signature'] = signature;\n    }\n\n    // Tentar enviar com retry\n    for (let attempt = 0; attempt <= this.retries; attempt++) {\n      try {\n        const response = await this.makeRequest(this.endpoint, {\n          method: 'POST',\n          headers,\n          body: payload\n        });\n\n        if (response.ok) {\n          const result = await response.json();\n          return result;\n        } else {\n          throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n        }\n      } catch (error) {\n        if (attempt === this.retries) {\n          throw error;\n        }\n        \n        // Aguardar antes de tentar novamente\n        await this.delay(1000 * (attempt + 1));\n      }\n    }\n  }\n\n  async makeRequest(url, options) {\n    if (isBrowser()) {\n      return await fetch(url, {\n        ...options,\n        signal: AbortSignal.timeout(this.timeout)\n      });\n    } else if (isNode()) {\n      // Para Node.js, usar fetch nativo (Node 18+) ou implementa√ß√£o alternativa\n      try {\n        const fetch = globalThis.fetch || require('node-fetch');\n        return await fetch(url, options);\n      } catch (error) {\n        throw new Error('Fetch n√£o dispon√≠vel no Node.js. Instale node-fetch ou use Node.js 18+');\n      }\n    } else {\n      throw new Error('Ambiente n√£o suportado para requisi√ß√µes HTTP');\n    }\n  }\n\n  delay(ms) {\n    return new Promise(resolve => setTimeout(resolve, ms));\n  }\n}\n\nexport { DataSender };\n\n","import { DataCollector } from './collector.js';\nimport { DataSender } from './sender.js';\nimport { generateId, isBrowser, isNode } from './utils.js';\n\nclass Veritas {\n  constructor(options = {}) {\n    this.options = {\n      endpoint: options.endpoint,\n      secret: options.secret,\n      autoCollect: options.autoCollect !== false, // true por padr√£o\n      collectInterval: options.collectInterval || 30000, // 30 segundos\n      timeout: options.timeout || 5000,\n      retries: options.retries || 2,\n      debug: options.debug || false,\n      ...options\n    };\n\n    this.collector = new DataCollector();\n    this.sender = new DataSender({\n      endpoint: this.options.endpoint,\n      secret: this.options.secret,\n      timeout: this.options.timeout,\n      retries: this.options.retries\n    });\n\n    this.sessionId = generateId();\n    this.isInitialized = false;\n    this.collectTimer = null;\n\n    if (this.options.debug) {\n      console.log('Veritas inicializado com op√ß√µes:', this.options);\n    }\n  }\n\n  // Inicializar o SDK\n  init() {\n    if (this.isInitialized) {\n      console.warn('SDK j√° foi inicializado');\n      return;\n    }\n\n    this.isInitialized = true;\n\n    if (this.options.autoCollect && isBrowser()) {\n      this.startAutoCollection();\n    }\n\n    if (this.options.debug) {\n      console.log('SDK inicializado com sucesso');\n    }\n\n    return this;\n  }\n\n  // Iniciar coleta autom√°tica (apenas no browser)\n  startAutoCollection() {\n    if (!isBrowser()) {\n      console.warn('Coleta autom√°tica dispon√≠vel apenas no browser');\n      return;\n    }\n\n    if (this.collectTimer) {\n      clearInterval(this.collectTimer);\n    }\n\n    this.collectTimer = setInterval(() => {\n      this.collectAndSend().catch(error => {\n        if (this.options.debug) {\n          console.error('Erro na coleta autom√°tica:', error);\n        }\n      });\n    }, this.options.collectInterval);\n\n    if (this.options.debug) {\n      console.log('Coleta autom√°tica iniciada');\n    }\n  }\n\n  // Parar coleta autom√°tica\n  stopAutoCollection() {\n    if (this.collectTimer) {\n      clearInterval(this.collectTimer);\n      this.collectTimer = null;\n      \n      if (this.options.debug) {\n        console.log('Coleta autom√°tica parada');\n      }\n    }\n  }\n\n  // Coletar dados manualmente\n  collect() {\n    try {\n      const data = this.collector.collectAll();\n      data.sdkVersion = '1.0.0';\n      data.sdkSessionId = this.sessionId;\n      \n      if (this.options.debug) {\n        console.log('Dados coletados:', data);\n      }\n      \n      return data;\n    } catch (error) {\n      if (this.options.debug) {\n        console.error('Erro ao coletar dados:', error);\n      }\n      throw error;\n    }\n  }\n\n  // Enviar dados manualmente\n  async send(data) {\n    if (!this.options.endpoint) {\n      throw new Error('Endpoint n√£o configurado');\n    }\n\n    try {\n      const result = await this.sender.sendData(data);\n      \n      if (this.options.debug) {\n        console.log('Dados enviados com sucesso:', result);\n      }\n      \n      return result;\n    } catch (error) {\n      if (this.options.debug) {\n        console.error('Erro ao enviar dados:', error);\n      }\n      throw error;\n    }\n  }\n\n  // Coletar e enviar dados\n  async collectAndSend() {\n    const data = this.collect();\n    return await this.send(data);\n  }\n\n  // Verificar risco de uma a√ß√£o espec√≠fica\n  async checkRisk(actionData = {}) {\n    const data = this.collect();\n    data.action = actionData;\n    \n    return await this.send(data);\n  }\n\n  // Destruir o SDK\n  destroy() {\n    this.stopAutoCollection();\n    this.isInitialized = false;\n    \n    if (this.options.debug) {\n      console.log('SDK destru√≠do');\n    }\n  }\n\n  // Atualizar configura√ß√µes\n  configure(newOptions) {\n    this.options = { ...this.options, ...newOptions };\n    \n    // Atualizar sender com novas configura√ß√µes\n    this.sender = new DataSender({\n      endpoint: this.options.endpoint,\n      secret: this.options.secret,\n      timeout: this.options.timeout,\n      retries: this.options.retries\n    });\n\n    if (this.options.debug) {\n      console.log('SDK reconfigurado:', this.options);\n    }\n  }\n}\n\n// Fun√ß√£o de conveni√™ncia para inicializa√ß√£o r√°pida\nfunction initSDK(options = {}) {\n  const sdk = new Veritas(options);\n  return sdk.init();\n}\n\n// Exporta√ß√µes\nexport { Veritas, initSDK };\nexport default Veritas;\n\n"],"names":["debounce","func","wait","timeout","args","clearTimeout","setTimeout","isNode","window","global","isBrowser","document","simpleHash","str","hash","length","i","charCodeAt","Math","abs","toString","DataCollector","constructor","this","mouseEvents","keyboardEvents","focusEvents","scrollEvents","sessionData","initBrowserCollectors","debouncedMouseMove","e","push","x","clientX","y","clientY","timestamp","Date","now","slice","debouncedKeyboard","key","ctrlKey","altKey","shiftKey","focusHandler","type","target","tagName","debouncedScroll","scrollX","scrollY","addEventListener","getBrowserInfo","userAgent","navigator","language","languages","platform","cookieEnabled","doNotTrack","hardwareConcurrency","maxTouchPoints","vendor","vendorSub","getScreenInfo","width","screen","height","availWidth","availHeight","colorDepth","pixelDepth","orientation","devicePixelRatio","getTimezoneInfo","timezone","Intl","DateTimeFormat","resolvedOptions","timeZone","timezoneOffset","getTimezoneOffset","getTime","locale","getCanvasFingerprint","canvas","createElement","ctx","getContext","textBaseline","font","fillText","fillStyle","fillRect","toDataURL","error","getWebGLFingerprint","gl","renderer","getParameter","RENDERER","VENDOR","version","VERSION","shadingLanguageVersion","SHADING_LANGUAGE_VERSION","getAudioFingerprint","audioContext","AudioContext","webkitAudioContext","oscillator","createOscillator","analyser","createAnalyser","gainNode","createGain","connect","destination","frequency","value","gain","fingerprint","sampleRate","state","frequencyBinCount","close","getPluginsInfo","plugins","plugin","name","description","filename","getStorageInfo","storage","localStorage","sessionStorage","indexedDB","webSQL","openDatabase","collectAll","sessionId","browser","fingerprints","webgl","audio","behavior","async","createHmac","message","secret","crypto","subtle","Error","importKey","TextEncoder","encode","signature","sign","btoa","String","fromCharCode","Uint8Array","browserHmac","globalThis","require","update","digest","nodeHmac","DataSender","options","endpoint","retries","sendData","data","payload","JSON","stringify","console","warn","headers","attempt","response","makeRequest","method","body","ok","json","status","statusText","delay","url","fetch","signal","AbortSignal","ms","Promise","resolve","Veritas","autoCollect","collectInterval","debug","collector","sender","random","substr","isInitialized","collectTimer","log","init","startAutoCollection","clearInterval","setInterval","collectAndSend","catch","stopAutoCollection","collect","sdkVersion","sdkSessionId","send","result","checkRisk","actionData","action","destroy","configure","newOptions"],"mappings":"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"}