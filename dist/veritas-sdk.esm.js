async function e(e,t){if("undefined"!=typeof window&&void 0!==window.document)return await async function(e,t){if(!crypto||!crypto.subtle)throw new Error("Web Crypto API não disponível");const n=await crypto.subtle.importKey("raw",(new TextEncoder).encode(t),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),o=await crypto.subtle.sign("HMAC",n,(new TextEncoder).encode(e));return btoa(String.fromCharCode(...new Uint8Array(o)))}(e,t);if("undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node)return async function(e,t){try{let n;if("undefined"!=typeof require?n=require("crypto"):"undefined"!=typeof process&&process.versions?.node&&(n=(await import("crypto")).default),n?.createHmac)return n.createHmac("sha256",t).update(e).digest("base64");throw new Error("createHmac não disponível")}catch(e){throw new Error("Módulo crypto do Node.js não disponível")}}(e,t);throw new Error("Ambiente não suportado para HMAC")}async function t(t,n,o){try{return await e(t,o)===n}catch(e){return!1}}const n=20,o=15,r=5,s=25,i=20,a=10,c=30;function u(e){let t=0;return t+=e.fingerprints?.canvas?0:n,t+=e.fingerprints?.webgl?0:o,t+=e.fingerprints?.audio?0:r,t+=e.behavior?.mouseEvents?.length<5?s:0,t+=e.behavior?.keyboardEvents?.length<3?i:0,t+="UTC"===e.timezone?.timezone?a:0,t+="purchase"===e.action?.action&&e.action?.amount>1e3?c:0,Math.min(100,t)}function d(e,t,n=45){let o="allow";o=e>=n?"deny":e>=.7*n?"review":"allow";const r=[];return e>=50&&r.push("Comportamento suspeito detectado"),t.fingerprints?.canvas||r.push("Fingerprint de canvas ausente"),t.action?.amount>1e3&&r.push("Valor de transação alto"),{decision:o,reasons:r}}class p{constructor(e={}){this.options=e}collect(){return function(){const e=[],t=[];return window.addEventListener("mousemove",(t=>{e.push({x:t.clientX,y:t.clientY,t:Date.now()}),e.length>100&&e.shift()})),window.addEventListener("focus",(e=>{t.push({type:"focus",t:Date.now()})})),window.addEventListener("blur",(e=>{t.push({type:"blur",t:Date.now()})})),{userAgent:navigator.userAgent,language:navigator.language,screen:{width:window.screen.width,height:window.screen.height},timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,mouseMoves:e,focusEvents:t}}()}async send(t){return async function(t,n){const o=await e(JSON.stringify(t),n.secret);return await fetch(n.endpoint,{method:"POST",headers:{"Content-Type":"application/json","X-SDK-Signature":o},body:JSON.stringify(t)})}(t,this.options)}async collectAndSend(){const e=this.collect();return this.send(e)}async checkRisk(e){const t=this.collect();t.action=e;const n=await this.send(t);return await n.json()}startAutoCollection(){}stopAutoCollection(){}configure(e){Object.assign(this.options,e)}destroy(){}}function l(e={}){return new p(e)}export{p as Veritas,e as createHmac,p as default,u as evaluateRisk,l as init,d as riskDecision,t as verifyHmac};
//# sourceMappingURL=veritas-sdk.esm.js.map
